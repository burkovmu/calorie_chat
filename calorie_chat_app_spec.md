
# Calorie Chat App ‚Äî –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ Cursor

> –≠—Ç–æ—Ç —Ñ–∞–π–ª ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ **—á–∞—Ç–∞**, –≥–¥–µ –ò–ò –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç—Ä–µ–±–ª—ë–Ω–Ω—É—é –µ–¥—É, —É—Ç–æ—á–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–∏—ë–º—ã –ø–∏—â–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ —Å—Ä–µ–¥–µ Cursor (Next.js/React), –±–µ–∫–µ–Ω–¥ ‚Äî Next.js API routes; –±–∞–∑–∞ ‚Äî PostgreSQL / Supabase.

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ò–¥–µ—è –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ](#–∏–¥–µ—è-–∏-–ø–æ–≤–µ–¥–µ–Ω–∏–µ)  
2. [UX / —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±—â–µ–Ω–∏—è (–ø—Ä–∏–º–µ—Ä)](#ux--—Å—Ü–µ–Ω–∞—Ä–∏–∏-–æ–±—â–µ–Ω–∏—è-–ø—Ä–∏–º–µ—Ä)  
3. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)  
4. [–§—Ä–æ–Ω—Ç–µ–Ω–¥ (Cursor / Next.js + React)](#—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-cursor--nextjs--react)  
5. [–ë–µ–∫–µ–Ω–¥ ‚Äî API](#–±–µ–∫–µ–Ω–¥--api)  
6. [–ò–ò: –ø—Ä–æ–º–ø—Ç—ã, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –ø–∞—Ä—Å–∏–Ω–≥ JSON](#–∏–∏-–ø—Ä–æ–º–ø—Ç—ã-–ø—Ä–æ–≤–µ—Ä–∫–∞-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã-–ø–∞—Ä—Å–∏–Ω–≥-json)  
7. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî —Å—Ö–µ–º–∞ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö--—Å—Ö–µ–º–∞-–∏-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)  
8. [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏](#–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è-–∏-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)  
9. [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—è](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–≤–∞–ª–∏–¥–∞—Ü–∏—è)  
10. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ QA](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-qa)  
11. [–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ](#—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ-–∏-–æ–∫—Ä—É–∂–µ–Ω–∏–µ)  
12. [–†–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ roadmap](#—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è-–∏-roadmap)  
13. [–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –ø—É–Ω–∫—Ç—ã / —á–µ–∫–ª–∏—Å—Ç](#–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ-–ø—É–Ω–∫—Ç—ã--—á–µ–∫–ª–∏—Å—Ç)

---

## –ò–¥–µ—è –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî —á–∞—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç —á—Ç–æ –æ–Ω —Å—ä–µ–ª, –ò–ò –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã (–Ω–∞–∑–≤–∞–Ω–∏–µ, –ø—Ä–∏–º–µ—Ä–Ω—ã–π –≤–µ—Å, –∫–∞–ª–æ—Ä–∏–∏), –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —á–∞—Ç–µ —Ä–∞–∑–±–∏—Ç—ã–º –ø–æ –ø–æ–∑–∏—Ü–∏—è–º –∏ —Å—É–º–º–æ–π. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ª—é–±—É—é –ø–æ–∑–∏—Ü–∏—é (–≤–µ—Å, –Ω–∞–∑–≤–∞–Ω–∏–µ, –¥–∞–∂–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é). –ö–æ–≥–¥–∞ –≤—Å—ë –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ ‚Äî –Ω–∞–∂–∞—Ç—å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –¥–Ω–µ–≤–Ω–∏–∫" –∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–Ω–æ—Å—è—Ç—Å—è –≤ –±–∞–∑—É.  

–ö–ª—é—á–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –ü–æ–Ω—è—Ç–Ω—ã–π –¥–∏–∞–ª–æ–≥–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –±—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç –ò–ò.
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π inline (–º–æ–¥–∞–ª/–∏–Ω–ª–∞–π–Ω-—Ä–µ–¥–∞–∫—Ç–æ—Ä).
- –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–≤–µ—Ä–Ω–æ–≥–æ JSON –æ—Ç –ò–ò: –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å.
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∑–∞–ø–∏—Å–∏ (–¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –æ—Ç—á—ë—Ç–æ–≤).
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è: —Ñ–æ—Ç–æ-—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ, barcode, —Ä–µ—Ü–µ–ø—Ç—ã, –∏–º–ø–æ—Ä—Ç—ã.

---

## UX / —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±—â–µ–Ω–∏—è (–ø—Ä–∏–º–µ—Ä)

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:**  
> –°–µ–≥–æ–¥–Ω—è –Ω–∞ –æ–±–µ–¥ –µ–ª –∫—É—Ä–∏–Ω—É—é –≥—Ä—É–¥–∫—É, —Å–∞–ª–∞—Ç –∏–∑ –æ–≥—É—Ä—Ü–æ–≤ –∏ –ø–æ–º–∏–¥–æ—Ä–æ–≤, –∫—É—Å–æ—á–µ–∫ —Ö–ª–µ–±–∞ –∏ —á–∞–π —Å —Å–∞—Ö–∞—Ä–æ–º.

**–ò–ò (–æ—Ç–≤–µ—Ç):**  
> –Ø –ø–æ–Ω—è–ª —Ç–∞–∫ (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–æ –≤–µ—Å–∞–º ‚Äî –∏—Ö –º–æ–∂–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å):  
> 1. –ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ ‚Äî 150 –≥ ‚Üí 248 –∫–∫–∞–ª  
> 2. –°–∞–ª–∞—Ç (–æ–≥—É—Ä—Ü—ã, –ø–æ–º–∏–¥–æ—Ä—ã) ‚Äî 200 –≥ ‚Üí 34 –∫–∫–∞–ª  
> 3. –•–ª–µ–± ‚Äî 30 –≥ ‚Üí 80 –∫–∫–∞–ª  
> 4. –ß–∞–π —Å —Å–∞—Ö–∞—Ä–æ–º (1 —á.–ª. ~ 4 –≥ —Å–∞—Ö–∞—Ä–∞) ‚Äî 200 –º–ª ‚Üí 16 –∫–∫–∞–ª  
> **–ò—Ç–æ–≥–æ:** 378 –∫–∫–∞–ª  
> [‚úèÔ∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å] [‚úÖ –í—Å—ë –≤–µ—Ä–Ω–æ]

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ —Ä–∞—Å—á—ë—Ç—É:** –∫–∞–ª–æ—Ä–∏–∏ –æ—Ü–µ–Ω–µ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:
> - –∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ (–≥–æ—Ç–æ–≤–∞—è) ‚Äî 165 –∫–∫–∞–ª / 100 –≥ ‚Üí 1.65 –∫–∫–∞–ª/–≥ ‚Üí 150 –≥ √ó 1.65 = 247.5 ‚Üí 248 –∫–∫–∞–ª  
> - —Å–∞–ª–∞—Ç (—Å—Ä–µ–¥–Ω–µ–µ) ‚Äî ~17 –∫–∫–∞–ª / 100 –≥ ‚Üí 0.17 –∫–∫–∞–ª/–≥ ‚Üí 200 –≥ √ó 0.17 = 34 –∫–∫–∞–ª  
> - —Ö–ª–µ–± ‚Äî 265 –∫–∫–∞–ª / 100 –≥ ‚Üí 2.65 –∫–∫–∞–ª/–≥ ‚Üí 30 –≥ √ó 2.65 = 79.5 ‚Üí 80 –∫–∫–∞–ª  
> - —Å–∞—Ö–∞—Ä ‚Äî 4 –∫–∫–∞–ª / –≥ ‚Üí 4 –≥ √ó 4 = 16 –∫–∫–∞–ª

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "‚úèÔ∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å" —É –∫—É—Ä–∏—Ü—ã –∏ –ø–∏—à–µ—Ç "–ù–µ 150, –∞ 120 –≥", –ò–ò –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—É—é —Å—É–º–º—É.

**–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è**: –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `meals` (–ø–æ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç) —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ user_id –∏ –¥–∞—Ç–µ/–≤—Ä–µ–º–µ–Ω–∏.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ö–æ—Ä–æ—Ç–∫–æ:  
- Frontend: React (Next.js –≤ Cursor), –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —á–∞—Ç–∞, –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.  
- Backend: Next.js API routes (`/api/analyze`, `/api/saveMeal`, `/api/meals`, `/api/editMeal`). –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞: –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–º–ø—Ç–∞, –≤—ã–∑–æ–≤ –ò–ò, –ø–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ.  
- AI: OpenAI (–∏–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è LLM) ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç JSON —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤.  
- DB: PostgreSQL / Supabase.  

–î–∏–∞–≥—Ä–∞–º–º–∞ (–ª–æ–≥–∏—á–µ—Å–∫–∞—è):
```
[Browser/Client (Cursor UI)] <--HTTP--> [Next.js API routes] <--HTTP/SQL--> [Postgres/Supabase]
                                        \
                                         -> [OpenAI / LLM] (chat completions)
```

---

## –§—Ä–æ–Ω—Ç–µ–Ω–¥ (Cursor / Next.js + React)

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–ø—Ä–∏–º–µ—Ä `package.json`)
```json
{
  "dependencies": {
    "react": "18.x",
    "next": "13.x",
    "swr": "^2.0.0",
    "axios": "^1.0.0",
    "zustand": "^4.0.0",
    "dayjs": "^1.11.0"
  },
  "devDependencies": {
    "typescript": "^5.0.0"
  }
}
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- `ChatPage` ‚Äî –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —á–∞—Ç–æ–º.  
- `MessageList` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ (user / assistant / system).  
- `ChatInput` ‚Äî –ø–æ–ª–µ –≤–≤–æ–¥–∞ + –∫–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å + —Ñ–∞–π–ª/—Ñ–æ—Ç–æ.  
- `MealCard` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ò–ò: —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –≤–µ—Å–∞, –∫–∞–ª–æ—Ä–∏–∏, –∫–Ω–æ–ø–∫–∏ `‚úèÔ∏è` –∏ `‚úÖ`.  
- `EditProductModal` ‚Äî –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞.  

### –ü—Ä–∏–º–µ—Ä: `ChatPage` (React + hooks, —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π)
```jsx
// components/ChatPage.jsx
import { useState } from "react";
import MessageList from "./MessageList";
import ChatInput from "./ChatInput";
import MealCard from "./MealCard";

export default function ChatPage({ user }) {
  const [messages, setMessages] = useState([]); // {role, text, meta}
  const [pendingMeal, setPendingMeal] = useState(null); // meal JSON –æ—Ç –ò–ò

  async function handleSend(text) {
    setMessages(prev => [...prev, { role: "user", text }]);
    const res = await fetch("/api/analyze", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text })
    });
    const json = await res.json();
    // json: { mealData, displayText }
    setPendingMeal(json.mealData);
    setMessages(prev => [...prev, { role: "assistant", text: json.displayText }]);
  }

  async function handleConfirm() {
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å pendingMeal –≤ /api/saveMeal
    await fetch("/api/saveMeal", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ userId: user.id, mealData: pendingMeal })
    });
    setMessages(prev => [...prev, { role: "system", text: "–ó–∞–ø–∏—Å–∞–Ω–æ –≤ –¥–Ω–µ–≤–Ω–∏–∫" }]);
    setPendingMeal(null);
  }

  return (
    <div>
      <MessageList messages={messages} />
      {pendingMeal && <MealCard meal={pendingMeal} onConfirm={handleConfirm} onEdit={setPendingMeal} />}
      <ChatInput onSend={handleSend} />
    </div>
  );
}
```

### `MealCard` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏ `‚úèÔ∏è` –∏ `üóë`.
- –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å `weight` –∏–ª–∏ `name`. –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞–ª–æ—Ä–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫—É –≤ `/api/analyze`/`/api/recalculate`.

–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (TypeScript):
```ts
type Product = {
  id?: string; // –≤—Ä–µ–º–µ–Ω–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π id
  name: string;
  weight_g?: number; // –≥—Ä–∞–º–º—ã
  calories?: number; // integer
};

type Meal = {
  products: Product[];
  total_calories: number;
  timestamp?: string;
};
```

### –í–∞—Ä–∏–∞–Ω—Ç –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
- –î–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–µ—Ä–µ—Å—á—ë—Ç –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–º –ø–ª–æ—Ç–Ω–æ—Å—Ç—è–º (kcal/100g) ‚Äî –¥–µ—Ä–∂–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π lookup table. –ù–æ –ø—Ä–∏ —Å–æ–º–Ω–µ–Ω–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä/–ò–ò –¥–ª—è –æ—Ü–µ–Ω–∫–∏.

---

## –ë–µ–∫–µ–Ω–¥ ‚Äî API

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–º–∏–Ω–∏–º—É–º):
- `POST /api/analyze` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç –æ–ø–∏—Å–∞–Ω–∏—è –µ–¥—ã, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `mealData` (JSON).
- `POST /api/saveMeal` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–π mealData –≤ –±–∞–∑—É —Å user_id.
- `GET /api/meals?date=YYYY-MM-DD` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ –∑–∞ –¥–∞—Ç—É.
- `PATCH /api/meals/:mealId` ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –ø—Ä–∏—ë–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
- `POST /api/recalculate` ‚Äî –æ–ø—Ü–∏—è: –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∫–∞–ª–æ—Ä–∏–∏ (–≤—ã–∑—ã–≤–∞—Ç—å –ò–ò) –ø–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫.

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ `/api/analyze` (Node.js, Next.js)
```js
// pages/api/analyze.js
import fetch from "node-fetch";

const OPENAI_KEY = process.env.OPENAI_API_KEY;
const MODEL = process.env.OPENAI_MODEL || "gpt-4o-mini";

export default async function handler(req, res) {
  try {
    const { text } = req.body;
    if (!text) return res.status(400).json({ error: "text required" });

    const prompt = `
You are a nutrition assistant. Parse the user's free-text description of what they ate and return a JSON with keys:
{
  "products": [
    {"name": "...", "weight_g": 120, "calories": 198}
  ],
  "total_calories": 198
}
Rules:
- If weight is not specified, estimate a reasonable weight and note assumptions.
- Use kcal per 100g typical values when estimating.
- Return strictly valid JSON only (no extra commentary).
User text:
---
${text}
---
`;

    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${OPENAI_KEY}`
      },
      body: JSON.stringify({
        model: MODEL,
        messages: [{ role: "user", content: prompt }],
        max_tokens: 700,
        temperature: 0.0
      })
    });
    const data = await response.json();
    const content = data.choices?.[0]?.message?.content || "";

    // –ù–∞–¥—ë–∂–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ JSON: –∏—â–µ–º JSON-–æ–±—ä–µ–∫—Ç –≤ –æ—Ç–≤–µ—Ç–µ
    const jsonMatch = content.match(/\{[\s\S]*\}/);
    if (!jsonMatch) throw new Error("No JSON in model response");

    const mealData = JSON.parse(jsonMatch[0]);
    // TODO: validate mealData against schema (see below)

    return res.status(200).json({
      mealData,
      displayText: mealData.products.map((p, i) => `${i+1}. ${p.name} ‚Äî ${p.weight_g ?? "?"} –≥ (${p.calories ?? "?"} –∫–∫–∞–ª)`).join("\n") + `\n\n–ò—Ç–æ–≥–æ: ${mealData.total_calories} –∫–∫–∞–ª`
    });
  } catch (err) {
    console.error(err);
    return res.status(500).json({ error: err.message || "server error" });
  }
}
```

### –ü—Ä–∏–º–µ—Ä `/api/saveMeal` (—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π)
```js
// pages/api/saveMeal.js
import { pool } from "../../lib/db"; // pg pool, –∏–ª–∏ supabase client

export default async function handler(req, res) {
  const { userId, mealData } = req.body;
  if (!userId || !mealData) return res.status(400).json({ error: "userId and mealData required" });

  const client = await pool.connect();
  try {
    await client.query("BEGIN");
    const insertMealQuery = `INSERT INTO meals (user_id, meal_time, total_calories) VALUES ($1, NOW(), $2) RETURNING id`;
    const mealResult = await client.query(insertMealQuery, [userId, mealData.total_calories ?? null]);
    const mealId = mealResult.rows[0].id;

    const insertProductText = `INSERT INTO meal_products (meal_id, product_name, weight_g, calories) VALUES ($1, $2, $3, $4)`;
    for (const p of mealData.products) {
      await client.query(insertProductText, [mealId, p.name, p.weight_g ?? null, p.calories ?? null]);
    }
    await client.query("COMMIT");
    res.status(200).json({ success: true, mealId });
  } catch (err) {
    await client.query("ROLLBACK");
    console.error(err);
    res.status(500).json({ error: err.message });
  } finally {
    client.release();
  }
}
```

---

## –ò–ò: –ø—Ä–æ–º–ø—Ç—ã, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –ø–∞—Ä—Å–∏–Ω–≥ JSON

### –ü—Ä–æ–º–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —à–∞–±–ª–æ–Ω)
```
You are a helpful nutrition assistant. Given the user message describing foods, produce valid JSON following this schema:

{
  "products": [
    {"name": string, "weight_g": int_or_null, "calories": int_or_null, "notes": string_optional}
  ],
  "total_calories": int
}

Guidelines:
- Always return strictly valid JSON (no explanatory text outside JSON).
- If a value is unknown, set it to null and add a short "notes" explanation.
- Use realistic calorie densities (kcal per 100 g) for estimates and state assumptions in "notes" if necessary.
- Round calories to nearest integer.
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –ò–ò
- –ò—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ajv` –∏–ª–∏ `zod`) –≤ –±–µ–∫–µ–Ω–¥–µ, —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ JSON-—Å—Ö–µ–º–µ.  
- –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –æ—Ç–≤–µ—Ç–∏–ª–∞ –Ω–µ–≤–µ—Ä–Ω–æ (–Ω–µ JSON, –ø–æ–ª–µ –ø—Ä–æ–ø—É—â–µ–Ω–æ) ‚Äî —Å–¥–µ–ª–∞–π –¥–æ 2 –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ (–≤ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –¥–æ–±–∞–≤—å `You MUST return only JSON` –∏ –ø—Ä–∏–∫—Ä–µ–ø–∏ –ø–æ—Å–ª–µ–¥–Ω—é—é –º–æ–¥–µ–ª—å-–≤—ã–¥–∞—á—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞), –∞ –µ—Å–ª–∏ –≤—Å—ë –∂–µ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å ‚Äî –æ—Ç–≤–µ—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –Ω–∞ —É—Ç–æ—á–Ω–µ–Ω–∏–µ: *"–ù–µ —É–¥–∞–ª–æ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å ‚Äî –Ω–∞–ø–∏—à–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏–º–µ—Ä–Ω—ã–µ –≥—Ä–∞–º–º—ã –∫—É—Ä–∏—Ü—ã –∏ —Ç.–¥."*

### –ü—Ä–∏–º–µ—Ä JSON-schema (ajv)
```json
{
  "type": "object",
  "required": ["products", "total_calories"],
  "properties": {
    "products": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name"],
        "properties": {
          "name": {"type": "string"},
          "weight_g": {"type": ["integer", "null"]},
          "calories": {"type": ["integer", "null"]},
          "notes": {"type": ["string", "null"]}
        }
      }
    },
    "total_calories": {"type": "integer"}
  }
}
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî —Å—Ö–µ–º–∞ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

### –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞ (Postgres)

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  email TEXT UNIQUE,
  name TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE meals (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  meal_time TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  total_calories INTEGER,
  note TEXT
);

CREATE TABLE meal_products (
  id SERIAL PRIMARY KEY,
  meal_id INTEGER REFERENCES meals(id) ON DELETE CASCADE,
  product_name TEXT NOT NULL,
  weight_g INTEGER,
  calories INTEGER,
  notes TEXT
);
```

- `meals` —Ö—Ä–∞–Ω–∏—Ç –ø—Ä–∏—ë–º –ø–∏—â–∏ –∫–∞–∫ –µ–¥–∏–Ω–∏—Ü—É (–¥–∞—Ç–∞-–≤—Ä–µ–º—è, —Å—É–º–º–∞—Ä–Ω—ã–µ –∫–∞–ª–æ—Ä–∏–∏).  
- `meal_products` ‚Äî –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

### –ò–Ω–¥–µ–∫—Å—ã –∏ –∑–∞–ø—Ä–æ—Å—ã
- –ò–Ω–¥–µ–∫—Å –ø–æ `user_id` –∏ `meal_time` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥.
- –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å `calories` –ø–æ –¥–Ω—è–º:
```sql
SELECT date_trunc('day', meal_time) as day, SUM(total_calories) as total
FROM meals WHERE user_id = $1 AND meal_time >= $2 AND meal_time < $3
GROUP BY day ORDER BY day;
```

---

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: Supabase Auth –∏–ª–∏ NextAuth.js  
- Supabase –¥–∞—ë—Ç –≥–æ—Ç–æ–≤—É—é Postgres –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.  
- –î–ª—è –º–æ–±–∏–ª—å–Ω–æ–π/–¥–µ—Å–∫—Ç–æ–ø –≤–µ—Ä—Å–∏–∏ ‚Äî JWT –∏–∑ Supabase/NextAuth –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ `/api/*`.

–ü–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ `userId` –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –∏–∑–≤–ª–µ–∫–∞–π—Ç–µ –∏–∑ —Å–µ—Å—Å–∏–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±).

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—è

1. –í—Å–µ–≥–¥–∞ –ª–æ–≥–∏—Ä—É–π—Ç–µ –æ—Ç–≤–µ—Ç—ã –ò–ò (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏), –Ω–æ **–Ω–µ** —Ö—Ä–∞–Ω–∏—Ç–µ –ª–∏—à–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ —è–≤–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
2. –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞, –¥–ª–∏–Ω–∞).  
3. –ü—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º JSON –æ—Ç –ò–ò:
   - –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (regex –∏–∑–≤–ª–µ—á—å JSON).
   - –ï—Å–ª–∏ –Ω–µ —É–¥–∞—ë—Ç—Å—è ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å –ø—Ä–æ—Å—å–±–æ–π —É—Ç–æ—á–Ω–∏—Ç—å –≥—Ä–∞–º–º—ã/–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.  
4. –õ–æ–≥–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏ –≤ Sentry / Logflare.

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ QA

- –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –¥–ª—è:
  - –ø–∞—Ä—Å–µ—Ä–∞ –æ—Ç–≤–µ—Ç–∞ –ò–ò (–≤–∞–ª–∏–¥–Ω—ã–µ/–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ JSON);
  - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏);
  - —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (—Ä–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ).
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:
  - "end-to-end" —Å—Ü–µ–Ω–∞—Ä–∏–π: –≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ ‚Üí –∞–Ω–∞–ª–∏–∑ ‚Üí –ø—Ä–∞–≤–∫–∞ ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–∏—Å–µ–π –≤ –ë–î.
- –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API (–º–∞–∫—Å–∏–º—É–º –ø–∞—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–æ —É—á—Ç–∏—Ç–µ –ª–∏–º–∏—Ç—ã OpenAI).

---

## –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ø—Ä–∏–º–µ—Ä)
```
DATABASE_URL=postgres://...
OPENAI_API_KEY=sk-...
OPENAI_MODEL=gpt-4o-mini
NEXTAUTH_URL=https://your-app.example
SUPABASE_URL=...
SUPABASE_KEY=...
```

### –•–æ—Å—Ç–∏–Ω–≥
- Cursor (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Next.js) ‚Äî —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ API –≤ –æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ.
- Postgres: Supabase, Neon, Heroku Postgres.
- CI/CD: GitHub Actions ‚Üí deploy to Cursor / Vercel.

---

## –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ roadmap

- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ –µ–¥—ã (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Vision API) ‚Üí –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ + –æ—Ü–µ–Ω–∫–∞ –ø–æ—Ä—Ü–∏–∏.  
- Barcode scanner ‚Üí –∏—Å–∫–∞—Ç—å –≤ –ë–î –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å —Ç–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ—Ä—Ü–∏–∏ –∏ –∫–∞–ª–æ—Ä–∏—è—Ö.  
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Ç—Ä–µ–∫–µ—Ä–∞–º–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.  
- –ü–æ–¥—Å—á—ë—Ç –ë–ñ–£ (–±–µ–ª–∫–∏ / –∂–∏—Ä—ã / —É–≥–ª–µ–≤–æ–¥—ã).  
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ü–µ–ª–∏ –∫–∞–ª–æ—Ä–∏–π –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

---

## –ü—Ä–∏–º–µ—Ä—ã –¥–∏–∞–ª–æ–≥–æ–≤ –∏ —Ç–æ–Ω–∫–∏–µ –º–µ—Å—Ç–∞ (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

1. **–ù–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç—å**: "—Å–∞–ª–∞—Ç" ‚Äî —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å: "–±—ã–ª –ª–∏ –≤ —Å–∞–ª–∞—Ç–µ –º–∞–π–æ–Ω–µ–∑/–º–∞—Å–ª–æ/—Å—ã—Ä?"  
2. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ—Ä—Ü–∏–∏**: "–µ–ª –¥–≤–∞ –∫—É—Å–æ—á–∫–∞ —Ö–ª–µ–±–∞" ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å.  
3. **–ù–∞–ø–∏—Ç–∫–∏**: –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å: "—á–∞–π –±–µ–∑ —Å–∞—Ö–∞—Ä–∞ –∏–ª–∏ —Å —Å–∞—Ö–∞—Ä–æ–º? —Å–∫–æ–ª—å–∫–æ –ª–æ–∂–µ–∫?"  
4. **–•–ª–µ–±/–±—É–ª–æ—á–∫–∏**: –ª—É—á—à–µ —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å —Ñ–æ—Ä–º—É/—Ç–∏–ø (–±–∞—Ç–æ–Ω, —Ä–∂–∞–Ω–æ–π, —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–æ–π), —Ç–∞–∫ –∫–∞–∫ —É –Ω–∏—Ö —Ä–∞–∑–Ω–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å.

---

## –ß–µ–∫–ª–∏—Å—Ç —ç—Ç–∞–ø–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–µ–∫—Ç Cursor/Next.js, –ø–æ–¥–∫–ª—é—á–∏—Ç—å –±–∞–∑—É (Supabase).  
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–∞—Ç–∞ (–≤–≤–æ–¥/–æ—Ç–ø—Ä–∞–≤–∫–∞).  
3. –°–¥–µ–ª–∞—Ç—å `/api/analyze` –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å OpenAI (–≤–∞–ª–∏–¥–Ω—ã–π JSON).  
4. –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `MealCard` —Å –∫–Ω–æ–ø–∫–∞–º–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.  
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `/api/saveMeal` —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π –∏ —Ç–µ—Å—Ç–∞–º–∏.  
6. –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.  
7. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫.  
8. UI/UX polishing (–º–æ–¥–∞–ª—å–Ω—ã–µ, –ø–æ–¥—Å–∫–∞–∑–∫–∏).  
9. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ.

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ø—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è —Å–æ —Å—á—ë—Ç–æ–º (—á–∏—Å–ª–∞ –ø–æ—Å—á–∏—Ç–∞–Ω—ã –∞–∫–∫—É—Ä–∞—Ç–Ω–æ)

**–í–≤–æ–¥:** "–ù–∞ –æ–±–µ–¥ ‚Äî –∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ 120 –≥, —Å–∞–ª–∞—Ç 200 –≥, —Ö–ª–µ–± 30 –≥, —á–∞–π —Å 1 —á.–ª. —Å–∞—Ö–∞—Ä–∞."

**–û—Ü–µ–Ω–∫–∏ (–ø–ª–æ—Ç–Ω–æ—Å—Ç–∏):**
- –ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞: 165 –∫–∫–∞–ª / 100 –≥ ‚Üí 1.65 –∫–∫–∞–ª/–≥ ‚Üí 120 √ó 1.65 = 198 –∫–∫–∞–ª  
- –°–∞–ª–∞—Ç (–æ–≥—É—Ä–µ—Ü/–ø–æ–º–∏–¥–æ—Ä —Å—Ä–µ–¥–Ω–µ–µ): 17 –∫–∫–∞–ª / 100 –≥ ‚Üí 0.17 –∫–∫–∞–ª/–≥ ‚Üí 200 √ó 0.17 = 34 –∫–∫–∞–ª  
- –•–ª–µ–±: 265 –∫–∫–∞–ª / 100 –≥ ‚Üí 2.65 –∫–∫–∞–ª/–≥ ‚Üí 30 √ó 2.65 = 79.5 ‚Üí –æ–∫—Ä—É–≥–ª—è–µ–º –¥–æ 80 –∫–∫–∞–ª  
- –°–∞—Ö–∞—Ä: 4 –∫–∫–∞–ª / –≥ ‚Üí 1 —á.–ª. ‚âà 4 –≥ ‚Üí 4 √ó 4 = 16 –∫–∫–∞–ª

**–ò—Ç–æ–≥–æ:** 198 + 34 + 80 + 16 = **328 –∫–∫–∞–ª**

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ø–æ–ª–µ–∑–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –∏ lookup table (–∫—Ä–∞—Ç–∫–æ)

```js
// kcal per 100g lookup (–ø—Ä–∏–º–µ—Ä)
const KCAL_PER_100G = {
  "chicken_breast": 165,
  "cucumber": 16,
  "tomato": 18,
  "bread_white": 265,
  "sugar": 400 // kcal per 100g -> 4 kcal/g
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Ä–∞—Å—á—ë—Ç–µ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
function kcalFor(grams, kcalPer100g) {
  return Math.round((kcalPer100g / 100) * grams);
}
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –∏ –Ω–∞–±–æ—Ä –∫–æ–¥–æ–≤—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —á–∞—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –∫–∞–ª–æ—Ä–∏–π –≤ Cursor. –ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É:
- –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (README + –ø—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤).  
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (png / mermaid).  
- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ API-—Ç–µ—Å—Ç–æ–≤ (Postman / Insomnia).

---

–ê–≤—Ç–æ—Ä: AI-–ø–æ–º–æ—â–Ω–∏–∫ ‚Äî —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ Cursor  
–î–∞—Ç–∞: 2025-08-12


ps.
–¥–µ–ø–ª–æ–π –±—É–¥–µ—Ç vercel
–±–¥ supabase