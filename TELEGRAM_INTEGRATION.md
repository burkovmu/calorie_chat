# ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Mini App

## üì± –ß—Ç–æ —Ç–∞–∫–æ–µ Telegram Mini App

Telegram Mini App - —ç—Ç–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–Ω—É—Ç—Ä–∏ Telegram –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–∫–∏–¥–∞—Ç—å –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä.

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–ª—è Calorie Chat AI

- **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** —á–µ—Ä–µ–∑ Telegram
- **–ì–æ—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** - –Ω–µ –Ω—É–∂–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
- **Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** —á–µ—Ä–µ–∑ Telegram
- **–ü–æ–¥–µ–ª–∏—Ç—å—Å—è** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤ —á–∞—Ç–∞—Ö
- **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞

1. –ù–∞–ø–∏—à–∏—Ç–µ [@BotFather](https://t.me/botfather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:
   - –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Calorie Chat AI")
   - –í–≤–µ–¥–∏—Ç–µ username (–Ω–∞–ø—Ä–∏–º–µ—Ä: "calorie_chat_ai_bot")
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Mini App

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newapp` –±–æ—Ç—É @BotFather
2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –±–æ—Ç
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∫–æ–Ω–∫—É (512x512px)
5. –ü–æ–ª—É—á–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É @BotFather:

```
/setcommands
calorie_chat_ai_bot
start - –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
help - –ü–æ–º–æ—â—å
settings - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
```

## üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Telegram Web App SDK

```bash
npm install @twa-dev/sdk
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ

```tsx
import { WebApp } from '@twa-dev/sdk';

useEffect(() => {
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
  WebApp.ready();
  
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–º—ã
  WebApp.setHeaderColor('#3b82f6');
  WebApp.setBackgroundColor('#f9fafb');
  
  // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  const user = WebApp.initDataUnsafe?.user;
  if (user) {
    console.log('Telegram user:', user);
  }
}, []);
```

### 3. –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ Telegram

```tsx
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Telegram —Ü–≤–µ—Ç–æ–≤
const telegramColors = {
  primary: WebApp.themeParams.button_color || '#3b82f6',
  text: WebApp.themeParams.text_color || '#000000',
  background: WebApp.themeParams.bg_color || '#ffffff',
};

// –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ Telegram
const viewportHeight = WebApp.viewportHeight;
const viewportStableHeight = WebApp.viewportStableHeight;
```

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Telegram Mini App

### 1. –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ TelegramProvider.tsx    # –ü—Ä–æ–≤–∞–π–¥–µ—Ä Telegram –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ TelegramAuth.tsx        # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ TelegramShare.tsx       # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useTelegram.ts          # –•—É–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram API
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ telegram.ts             # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è Telegram
‚îî‚îÄ‚îÄ types/
    ‚îî‚îÄ‚îÄ telegram.ts             # –¢–∏–ø—ã Telegram
```

### 2. Telegram Provider

```tsx
// src/components/TelegramProvider.tsx
import { createContext, useContext, useEffect, useState } from 'react';
import { WebApp } from '@twa-dev/sdk';

interface TelegramContextType {
  user: any;
  theme: any;
  isReady: boolean;
  share: (text: string) => void;
}

const TelegramContext = createContext<TelegramContextType | null>(null);

export function TelegramProvider({ children }: { children: React.ReactNode }) {
  const [user, setUser] = useState(null);
  const [theme, setTheme] = useState(null);
  const [isReady, setIsReady] = useState(false);

  useEffect(() => {
    WebApp.ready();
    setUser(WebApp.initDataUnsafe?.user);
    setTheme(WebApp.themeParams);
    setIsReady(true);
  }, []);

  const share = (text: string) => {
    WebApp.showPopup({
      title: '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è',
      message: text,
      buttons: [
        { text: '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è', type: 'default' },
        { text: '–û—Ç–º–µ–Ω–∞', type: 'cancel' }
      ]
    });
  };

  return (
    <TelegramContext.Provider value={{ user, theme, isReady, share }}>
      {children}
    </TelegramContext.Provider>
  );
}

export const useTelegram = () => {
  const context = useContext(TelegramContext);
  if (!context) {
    throw new Error('useTelegram must be used within TelegramProvider');
  }
  return context;
};
```

### 3. –ê–¥–∞–ø—Ç–∞—Ü–∏—è ChatPage

```tsx
// src/components/ChatPage.tsx
import { useTelegram } from './TelegramProvider';

export default function ChatPage() {
  const { user, theme, share } = useTelegram();
  
  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Telegram –¥–∞–Ω–Ω—ã—Ö
  const [userId] = useState(user?.id?.toString() || 'demo-user');
  
  // –®–∞—Ä–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  const handleShare = () => {
    if (pendingMeal) {
      const shareText = `üçΩÔ∏è –Ø —Å—ä–µ–ª ${pendingMeal.total_calories} –∫–∫–∞–ª:\n${pendingMeal.products.map(p => `‚Ä¢ ${p.name} - ${p.calories} –∫–∫–∞–ª`).join('\n')}`;
      share(shareText);
    }
  };
  
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

## üé® –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω–∞

### 1. Telegram —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞

```css
/* src/app/globals.css */
:root {
  --tg-theme-bg-color: #ffffff;
  --tg-theme-text-color: #000000;
  --tg-theme-button-color: #3b82f6;
  --tg-theme-button-text-color: #ffffff;
  --tg-theme-hint-color: #999999;
  --tg-theme-link-color: #3b82f6;
  --tg-theme-secondary-bg-color: #f1f1f1;
}

/* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Telegram —Ü–≤–µ—Ç–æ–≤ */
.telegram-theme {
  background-color: var(--tg-theme-bg-color);
  color: var(--tg-theme-text-color);
}

.telegram-button {
  background-color: var(--tg-theme-button-color);
  color: var(--tg-theme-button-text-color);
}
```

### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã

```css
/* –ú–æ–±–∏–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è Telegram */
@media (max-width: 480px) {
  .telegram-container {
    padding: 0.5rem;
  }
  
  .telegram-button {
    min-height: 48px;
    font-size: 16px;
  }
  
  .telegram-input {
    min-height: 48px;
    font-size: 16px;
  }
}
```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```tsx
// src/lib/telegram.ts
import crypto from 'crypto';

export function validateTelegramData(initData: string, botToken: string): boolean {
  const urlParams = new URLSearchParams(initData);
  const hash = urlParams.get('hash');
  
  if (!hash) return false;
  
  // –£–¥–∞–ª—è–µ–º hash –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  urlParams.delete('hash');
  
  // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
  const params = Array.from(urlParams.entries())
    .sort(([a], [b]) => a.localeCompare(b))
    .map(([key, value]) => `${key}=${value}`)
    .join('\n');
  
  // –°–æ–∑–¥–∞–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á
  const secretKey = crypto.createHmac('sha256', 'WebAppData')
    .update(botToken)
    .digest();
  
  // –í—ã—á–∏—Å–ª—è–µ–º —Ö–µ—à
  const calculatedHash = crypto.createHmac('sha256', secretKey)
    .update(params)
    .digest('hex');
  
  return calculatedHash === hash;
}
```

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Supabase

```tsx
// src/lib/supabase.ts
import { supabase } from './supabase';

export async function signInWithTelegram(initData: string) {
  try {
    const { data, error } = await supabase.auth.signInWithPassword({
      email: `telegram_${Date.now()}@telegram.app`,
      password: initData, // –ò—Å–ø–æ–ª—å–∑—É–µ–º initData –∫–∞–∫ –ø–∞—Ä–æ–ª—å
    });
    
    if (error) throw error;
    return data;
  } catch (error) {
    console.error('Telegram auth error:', error);
    throw error;
  }
}
```

## üì± –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö

### 1. Touch-friendly –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```css
/* –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è –∫–∞—Å–∞–Ω–∏—è */
.touch-target {
  min-width: 44px;
  min-height: 44px;
}

/* –û—Ç—Å—Ç—É–ø—ã –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
.touch-spacing {
  margin: 8px;
  padding: 12px;
}
```

### 2. –ñ–µ—Å—Ç—ã –∏ –∞–Ω–∏–º–∞—Ü–∏–∏

```css
/* –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã */
.smooth-transition {
  transition: all 0.2s ease;
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
@keyframes slideUp {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}

.slide-up {
  animation: slideUp 0.3s ease-out;
}
```

## üöÄ –î–µ–ø–ª–æ–π –¥–ª—è Telegram

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

```bash
# –°–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
npm run build

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∫–∏
npm run start
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥ (Vercel, Netlify)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–º–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HTTPS
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Å—ã–ª–∫—É –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–æ—Ç–∞

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É Mini App
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

## üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### 1. Telegram Analytics

```tsx
// –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ Telegram
WebApp.sendData('meal_added', {
  calories: meal.total_calories,
  products_count: meal.products.length,
  timestamp: new Date().toISOString()
});
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```tsx
// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
WebApp.showAlert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –µ–¥—ã');
WebApp.showPopup({
  title: '–û—à–∏–±–∫–∞',
  message: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –µ–¥—ã',
  buttons: [{ text: 'OK', type: 'default' }]
});
```

## üîÆ –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

### 1. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- **Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ –ø—Ä–∏–µ–º–∞—Ö –ø–∏—â–∏
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º** Telegram
- **–®–∞—Ä–∏–Ω–≥ —Ä–µ—Ü–µ–ø—Ç–æ–≤** –≤ —á–∞—Ç—ã
- **–ì—Ä—É–ø–ø–æ–≤—ã–µ —Ü–µ–ª–∏** –ø–æ –∫–∞–ª–æ—Ä–∏—è–º

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

- **Lazy loading** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Service Worker** –¥–ª—è –æ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç—ã
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–∞–Ω–Ω—ã—Ö
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Telegram Bot API](https://core.telegram.org/bots/api)
2. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ [Telegram Bot Support](https://t.me/botsupport)
3. –°–æ–∑–¥–∞–π—Ç–µ Issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

**–£–¥–∞—á–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π! üöÄ** 